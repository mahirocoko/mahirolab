#!/bin/sh
#
# Git hook to prevent AI attribution in commit messages
# Validates against project's COMMIT_GUIDE.md requirements
#

COMMIT_MSG_FILE=$1

# Patterns to detect AI attribution (case-insensitive)
AI_PATTERNS=(
  "Generated with.*Claude"
  "Co-Authored-By:.*Claude"
  "Co-Authored-By:.*AI"
  "ü§ñ.*Generated"
  "claude\.com"
  "anthropic\.com"
  "@anthropic"
  "AI-generated"
  "AI generated"
  "Generated by AI"
  "Generated by Claude"
  "Assisted by"
  "With help from"
  "noreply@anthropic"
)

# Check commit message for AI attribution
for pattern in "${AI_PATTERNS[@]}"; do
  if grep -qiE "$pattern" "$COMMIT_MSG_FILE"; then
    echo ""
    echo "‚ùå ERROR: AI attribution detected in commit message"
    echo ""
    echo "Found pattern: $pattern"
    echo ""
    echo "According to docs/COMMIT_GUIDE.md:"
    echo "  - Do NOT include AI attribution"
    echo "  - No bot signatures, co-author credits, or AI-generated mentions"
    echo ""
    echo "Please remove AI attribution from your commit message."
    echo ""
    exit 1
  fi
done

# Success
exit 0